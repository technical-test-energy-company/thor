<?php

namespace App\Vulnerability;

use Illuminate\Pagination\CursorPaginator;
use Infrastructure\Constants\Constants;

class VulnerabilityService
{
    public function index(array $data): CursorPaginator
    {
        $limit = $data['limit'];
        $response = Vulnerability::orderBy(Constants::ID)->cursorPaginate($limit);

        return $response;
    }

    public function store(array $data): Vulnerability
    {
        $vulnerability = Vulnerability::create($data);
        VulnerabilityEnrichmentJob::dispatch($vulnerability);

        return $vulnerability;
    }

    public function update(array $data, Vulnerability $vulnerability): Vulnerability
    {
        $vulnerability->updateOrFail($data);

        return $vulnerability->fresh();
    }

    public function destroy(Vulnerability $vulnerability): void
    {
        $vulnerability->deleteOrFail();
    }
}
