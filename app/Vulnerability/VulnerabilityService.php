<?php

namespace App\Vulnerability;

use Illuminate\Pagination\CursorPaginator;
use Infrastructure\Constants\Constants;

class VulnerabilityService
{
    public function index($data): CursorPaginator
    {
        $limit = $data['limit'];
        $response = Vulnerability::orderBy(Constants::ID)->cursorPaginate($limit);

        return $response;
    }

    public function store($data): Vulnerability
    {
        // TODO: CHANGE THIS
        $vulnerability = Vulnerability::create($data);

        return $vulnerability;
    }

    public function update($data, Vulnerability $vulnerability): Vulnerability
    {
        $vulnerability->updateOrFail($data);

        return $vulnerability->fresh();
    }

    public function destroy(Vulnerability $vulnerability): void
    {
        $vulnerability->deleteOrFail();
    }
}
